# 技術コンテキスト: dotfiles

## 使用技術

### コア技術

1. **シェルスクリプト**
   - **目的**: インストールと設定の自動化
   - **主な用途**: シンボリックリンクの作成、ファイルのバックアップ、環境検出
   - **言語**: Bash（最も広く利用可能なシェル）

2. **Git**
   - **目的**: バージョン管理と同期
   - **主な用途**: 設定の変更履歴の追跡、複数マシン間での同期
   - **依存関係**: Git 2.0以上

3. **シンボリックリンク**
   - **目的**: 設定ファイルの管理
   - **主な用途**: リポジトリ内のファイルをホームディレクトリにリンク
   - **コマンド**: `ln -s`（Unix系）、`mklink`（Windows）

### シェル環境

1. **Bash**
   - **バージョン**: 4.0以上推奨
   - **設定ファイル**: `.bashrc`, `.bash_profile`, `.bash_aliases`
   - **特徴**: 広く利用可能、多くのシステムでデフォルト

2. **Zsh**
   - **バージョン**: 5.0以上推奨
   - **設定ファイル**: `.zshrc`, `.zprofile`, `.zshenv`
   - **特徴**: より高度な機能、カスタマイズ性が高い、macOSのデフォルト

3. **Fish**（オプション）
   - **バージョン**: 3.0以上
   - **設定ファイル**: `~/.config/fish/config.fish`
   - **特徴**: ユーザーフレンドリー、優れた補完機能

### エディタ

1. **Vim/Neovim**
   - **設定ファイル**: `.vimrc`, `init.vim`
   - **プラグイン管理**: vim-plug, Vundle, dein.vimなど
   - **主な設定**: キーマッピング、プラグイン、カラースキーム

2. **Visual Studio Code**
   - **設定ファイル**: `settings.json`, `keybindings.json`
   - **拡張機能**: 推奨拡張機能のリスト
   - **同期**: 設定の同期方法

3. **Emacs**（オプション）
   - **設定ファイル**: `.emacs`, `.emacs.d/init.el`
   - **パッケージ管理**: use-package, straight.elなど

### ターミナルマルチプレクサ

1. **tmux**
   - **設定ファイル**: `.tmux.conf`
   - **プラグイン管理**: tpm（Tmux Plugin Manager）
   - **主な設定**: キーバインド、ステータスライン、セッション管理

### バージョン管理

1. **Git**
   - **設定ファイル**: `.gitconfig`, `.gitignore_global`
   - **主な設定**: ユーザー情報、エイリアス、マージツール

## 開発環境

### 必要条件

1. **基本要件**
   - Unix系システム（Linux, macOS）またはWindows（WSL推奨）
   - Git 2.0以上
   - Bash 4.0以上またはZsh 5.0以上

2. **オプション要件**
   - Python 3.6以上（一部のスクリプトに使用）
   - Node.js 14以上（一部のツールに使用）
   - Ruby 2.5以上（一部のツールに使用）

### インストール手順

1. **リポジトリのクローン**
   ```bash
   git clone https://github.com/username/dotfiles.git ~/.dotfiles
   ```

2. **インストールスクリプトの実行**
   ```bash
   cd ~/.dotfiles
   ./install.sh
   ```

3. **シェルの再起動**
   ```bash
   exec $SHELL -l
   ```

### テスト環境

新しい設定をテストするための推奨アプローチ：

1. **Docker**
   - 異なるOSやシェル環境での設定のテスト
   - 例: `docker run -it ubuntu:20.04 bash`

2. **仮想マシン**
   - 完全な環境でのテスト
   - VirtualBox, VMware, Parallelsなどを使用

## 技術的制約

### クロスプラットフォームの互換性

1. **シェルの違い**
   - Bashの機能はシステムによって異なる場合がある
   - macOSのBashは古いバージョン（GNU Bashではなく）
   - Windowsでは、WSLまたはGit Bashを使用する必要がある

2. **パスの違い**
   - Windowsではバックスラッシュを使用
   - 設定ファイルの場所が異なる場合がある

3. **コマンドの違い**
   - 同じ機能でも、異なるOSで異なるコマンドが必要な場合がある
   - 例: `ls` vs `dir`, `grep` vs `findstr`

### セキュリティ考慮事項

1. **機密情報**
   - パスワード、APIキー、トークンなどをdotfilesに含めない
   - 代わりに環境変数または暗号化されたストレージを使用

2. **権限**
   - 適切なファイル権限を設定（特に実行可能スクリプト）
   - 例: `chmod 700 ~/.ssh`, `chmod 600 ~/.ssh/id_rsa`

## 依存関係

### 外部ツール

1. **必須ツール**
   - Git: バージョン管理
   - curl/wget: ダウンロード用
   - tar/unzip: アーカイブ展開用

2. **推奨ツール**
   - stow: シンボリックリンク管理の代替手段
   - shellcheck: シェルスクリプトの静的解析
   - bat: catの代替（シンタックスハイライト付き）
   - ripgrep: grepの高速な代替
   - fd: findの代替
   - fzf: ファジーファインダー

### プラグインマネージャー

1. **シェルプラグイン**
   - Oh My Zsh: Zshの拡張
   - Bash-it: Bashの拡張
   - Antigen/Antibody: Zshプラグイン管理

2. **Vimプラグイン**
   - vim-plug: プラグイン管理
   - Vundle: プラグイン管理の代替

3. **tmuxプラグイン**
   - tpm: Tmux Plugin Manager

## 技術的な決定理由

1. **Bashをデフォルトシェルスクリプトとして使用**
   - 理由: 最も広く利用可能で、ほとんどのシステムにプリインストールされている
   - トレードオフ: より高度な機能を持つシェル（Zsh、Fish）と比較して機能が制限される

2. **シンボリックリンクの使用**
   - 理由: 設定の変更がリアルタイムで反映され、バージョン管理が容易
   - トレードオフ: 一部のアプリケーションがシンボリックリンクを適切に処理しない場合がある

3. **モジュール式の構造**
   - 理由: 関連する設定をグループ化し、選択的なインストールを可能にする
   - トレードオフ: インストールスクリプトがより複雑になる

4. **ローカルオーバーライドの許可**
   - 理由: マシン固有の設定をリポジトリを変更せずに適用できる
   - トレードオフ: 設定の一部がバージョン管理されない

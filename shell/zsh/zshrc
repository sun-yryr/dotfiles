# ~/.zshrc file for zsh interactive shells.

# dotfilesディレクトリのパスを設定
export DOTFILES_DIR="${DOTFILES_DIR:-$HOME/Documents/dotfiles}"

# ------------------------------------------------------------
# 基本設定の読み込み
# ------------------------------------------------------------
for config_file in "$DOTFILES_DIR/shell/zsh/base"/*.zsh; do
  source "$config_file"
done

# ------------------------------------------------------------
# OSごとの設定の読み込み
# ------------------------------------------------------------
if [[ "$OSTYPE" == "darwin"* ]]; then
  # macOS
  source "$DOTFILES_DIR/shell/zsh/os/macos.zsh"
elif [[ "$OSTYPE" == "linux-gnu"* ]]; then
  # Linux
  if [ -f /etc/os-release ]; then
    . /etc/os-release
    if [[ "$ID" == "ubuntu" ]]; then
      # Ubuntu
      source "$DOTFILES_DIR/shell/zsh/os/ubuntu.zsh"
    fi
  fi
fi

# ------------------------------------------------------------
# ホスト名ベースの設定の読み込み
# ------------------------------------------------------------
HOST_CONFIG="$DOTFILES_DIR/shell/zsh/hosts/$(hostname).zsh"
if [ -f "$HOST_CONFIG" ]; then
  source "$HOST_CONFIG"
fi

# ------------------------------------------------------------
# ローカル設定の読み込み
# ------------------------------------------------------------
if [ -f "$HOME/.zshrc.local" ]; then
  source "$HOME/.zshrc.local"
fi

# ------------------------------------------------------------
# 基本設定（OSベースの環境変数に依存している）
# TODO: いい感じにしたい
# ------------------------------------------------------------
source $ZPLUG_HOME/init.zsh
zplug "b4b4r07/enhancd", use:init.sh
if ! zplug check --verbose; then
    printf "Install? [y/N]: "
    if read -q; then
        echo; zplug install
    fi
fi
zplug load

export GPG_TTY=$(tty)

# --------
# mise
# --------
eval "$(/home/sun-yryr/.local/bin/mise activate zsh)"

# ------------------------------------------------------------
# Starshipの起動（必ず最後に実行する）
# ------------------------------------------------------------
eval "$(starship init zsh)"
